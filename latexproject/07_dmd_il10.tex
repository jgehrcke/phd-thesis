\chapter{DMD applied to the IL-10-GAG system}

In order to exploit the predictive power of DMD for the IL-10-GAG system, we
have performed several DMD studies differing in DMD parameterization and
molecular system setup. Conducting these studies required an increment of the
computational resources available to us by orders of magnitudes. In the course
of performing these studies we continuously refined our software architecture
for controlling the corresponding high performance computing resources and
enriched our DMD data analysis framework. This chapter seeks to present
\textit{i)} the computational challenges, \textit{ii)} the methodological
details, and \textit{iii)} the major outcomes of this endeavor.


\section{Methods}

\subsection{Overall study design}
\label{dmdil10:overallmethod}

As a reminder, the term DMD study covers many DMD run repetitions followed by
data analysis. Hence, within a single DMD study the \textit{constants} are ---
among others --- the chemical configuration of the ligand molecule and the
geometrical DMD parametrization, i.e.\ the protein core atom and the focus
point. Clearly, a systematic investigation of the IL-10-GAG system via DMD
requires \textit{variation} of exactly these entities. That is, the planned
investigation requires the conduction of \textit{many} DMD studies. By the time
of designing the first IL-10-GAG DMD studies, the conduction and analysis of a
single study consumed about two weeks. Hence, time and computational resources
clearly limited the scope of this endeavor. In these lines, the requirement was
to get as much conclusive output out of as few DMD studies as possible.

\subsubsection{Factors to investigate}

The entities that are obviously interesting to vary among the different DMD
studies in case of the IL-10-GAG system are:

\begin{itemize}

\item[1)] \textbf{The DMD protocol.} In the course of performing various DMD
studies we aimed for slight protocol changes for optimizing the computational
efficiency of DMD, compared to the protocol initially developed for the DMD
validation study described in \cref{chapter:dmd}. We decided to potentially
optimize parameters such as decreasing the tMD simulation length as well as the
LROM displacement length, both of which have direct impact on the pulling
process velocity. A the same time, we tried to increase the number of
independent DMD run repetitions within single DMD studies as far as our
computational resources allowed to, in order to obtain as much sampling
performance as possible.

\item[2)] \textbf{The geometrical DMD parameterization.} In
\cref{chapter:bspred}, we have derived a region of interest for our DMD studies.
For potentially discovering a distinct and well-defined binding \textit{site}
and for investigating and finally eliminating the impact of the geometrical DMD
parameterization on any conclusion about the IL-10-GAG system, we decided to
vary DMD focus point and entry lane among the DMD studies. One should note
however, that in order to obtain reliable information about the impact of other
variables, this one here should stay constant most of the time, which is why we
decided to try only two different geometrical setups in the first round of DMD
studies, and a final third geometrical parameterization in the second round of
DMD studies.

\item[3)] \textbf{The representation of IL-10's N-terminus in the MD
simulations}. In IL-10's crystal structure with PDB 2ILK the first 5 residues of
the N-terminus are not resolved as of their flexibility. The N-terminus is close
to our main region of interest derived in \cref{chapter:bspred}. This is an
unfortunate situation, because if this terminus plays a role in GAG recognition,
it would not easily be possible for us to detect it --- modeling the behavior of
such flexible / disordered terminus is not possible with all certainty and
requires special sampling techniques on its own, not \textit{per se} combinable
with DMD. Primarily, we take the flexibility and sequence as an argument that
the N-terminus is surely less important for specific GAG interaction than the
amino acid residues in the region we have identified. Since simulating the
disordered N-terminus without special treatment is pointless, we have omitted
these five residues from most of our MD simulations. However, for having a
comparison, and for obtaining an idea about their possible impact, we decided to
include them in at least one or two test case DMD studies.

\item[4)] \textbf{The chemical configuration of GAG ligands.} Obviously, we had
the hope to identify characteristic differences among different GAG types and
lengths with respect to their interaction with our IL-10 region of interest.
Therefore, we aimed to perform DMD studies with constant conditions while
varying the chemical configuration of the GAG molecule. As of the limited amount
of computational resources, we had to decide which GAG types/lengths are most
interesting for our investigation and came up with the following selection:

\begin{itemize}

\item \textit{Heparin}, a must-have in this list, as its interaction with IL-10
has been experimentally confirmed previously \cite{salek_ardakani_2000}. We
decided to study heparin tetra- as well as hexasaccharides. In our DMD
validation study we have shown that DMD is capable of properly sampling the
internal degrees of freedom of GAG hexasaccharides. For longer GAGs, however, we
would be uncertain regarding the sufficiency of the sampling and --- with that
--- the reliability of the results. Additionally, tetrasaccharide investigation
is useful for observing potential (in)consistencies in our observations
depending on GAG length. Disaccharide investigation, however, would likely be a
waste of computational resources.

\item \textit{Hyaluronan}, which is the only natural GAG free of sulfation. As
of its lack of sulfate groups, besides of being less charged, it has
significantly different spatial properties than e.g.\ heparin: it is less bulky
(i.e.\ it is slim).

\item \textit{Chondroitin-4-sulfate}. The chondroitin sulfates are important
representatives of the class of GAGs. Compared to heparin, the 4- and 6-
variants of chondroitin sulfate have two sulfate groups less per disaccharide
unit (only one) and are therefore less charged and less bulky.

\item \textit{Chondroitin-6-sulfate}. Carbon 6 of the
N-Acetyl\-ga\-lacto\-sa\-mine is sulfated, meaning that the sulfate group is
protruding further into space than in case of chondroitin-4-sulfate, where the
sulfate is attached directly to the ring (cf. \cref{intro:gags}), providing this
GAG with quite different spatial properties than chondroitin-4-sulfate.

\end{itemize}

\end{itemize}

\subsubsection{Iterative approach}

For the global design of our DMD studies, we decided to take an iterative
approach. In a first round, we aimed to gather experience about how the
IL-10-GAG system responds to various kinds of DMD parameter changes.
Furthermore, since the technical environment was unstable, we used this first
round of studies for detecting and resolving technical issues. Hence, in this
first round of studies, we varied the conditions according to all points
described above, with the goal to obtain stable conditions applicable in a
second round, together with an optimized geometrical DMD parameterization.


\subsubsection{Automated DMD data analysis}

For efficiently breaking the enormous amount of raw data produced by any DMD
study down to human-interpretable essentials, we specified and implemented an
automated data analysis framework. In this framework, every DMD run within a DMD
study is assigned a unique identifier. Subsequently, we extracted all
\textit{static} and \textit{dynamic} quantities for each DMD run listed in
\cref{dmd:dataanalysis}, and assigned those quantities to the corresponding
run identifiers. As a result, we obtained a table of dimensions $N \times M$,
with $N$ being the number of DMD runs and $M$ being the number of
single-run-derivable quantities. In a second class of analyses, the
ensemble-derivable quantities as described in \cref{dmd:dataanalysis} were
extracted from all runs in the DMD study, usually based on the single-run data
extraction performed before. Finally, we clustered the docking solution ensemble
using the method described in
\cref{chapter:bspred}.

The resulting reduced set of data allows for a broad subsequent data analysis.
For instance, any two single-run-derivable quantities can easily be correlated
for understanding their relationship, or the distribution of any extracted
quantity can easily be looked at and statistically evaluated. Furthermore, our
data analysis framework allows for generating cluster statistics based on the
\textit{clustering} of docking solutions. For instance, the average ligand
mobility within a certain cluster is easy to obtain. This enables meaningful
comparison of clusters by those properties, especially among \textit{different}
DMD studies.


\subsection{Computational framework}


\subsubsection{High performance computing requirements of one DMD study}

One DMD study according to the protocol as presented in \cref{chapter:dmd},
i.e.\ with $N = 100$ repetitions, a pulling process simulation time of
\SI{4}{\nano\second} and a free MD simulation time of \SI{10}{\nano\second}
implicates about \SI{1.4}{\micro\second} of simulated real time. As of these
numbers, one DMD study requires about 12 years ($10^5$ hours) of accumulated CPU
time using state-of-the-art hardware (such as the Intel Xeon Processor X5650).

In high performance computing (HPC), computational tasks are usually abstracted as
\enquote{jobs}, whereas a job is a sub-problem of an \enquote{embarrassingly
parallel} problem \cite{heath1986hypercube}, for which little or no effort is
required to separate the problem into a number of independent tasks. For
efficient use of HPC batch schedulers for DMD, we have abstracted a DMD study
into the following list of jobs (whereas some of the jobs named later in the
list require completion of those listed earlier):

\begin{itemize}
\item LROM system preparation jobs (minimization, heat-up, equilibration)
\item $N$ tMD production jobs
\item $N$ free MD jobs (minimization, heat-up, equilibration, production)
\item $N$ final state validation and energy minimization jobs
\item $N$ free MD trajectory analysis jobs (MM-PBSA)
\item $N$ free MD trajectory analysis jobs (MM-GBSA + SRED)
\item $N$ free MD trajectory analysis jobs (geometry and hydrogen bonding
analysis)
\end{itemize}

Depending on $N$, this yields on the order of $10^3$ computing jobs per DMD
study. The raw data created by those jobs comprises on the order of $10^2$
gigabytes distributed in about $10^5$ files.


\subsubsection{Establishment of GPU computing resources}

Initially, the execution of a single DMD study was possible for us within about
three weeks, using the \enquote{Atlas} resource pool in the supercomputing
center of the TU Dresden (ZIH), which provisions a large number of AMD Opteron
6274 CPUs. However, this system was affected by many technical issues, ran out
of support by the ZIH, and did not reliably allow us to perform various DMD
studies in parallel, or even increase the number of DMD run repetitions $N$. The
in-house computing cluster of the BIOTEC, TU Dresden (the
\enquote{biocluster}, comprised of about 30 machines) was out of question for
performing DMD studies as of too few resources.

For mitigating issues related to a lack of computing resources for DMD, we were
early adopters of a new technology: the usage of graphics processing units
(GPUs) for general purpose computing (\enquote{GPGPU} \cite{wikipedia_gpgpu}).
Simply spoken, GPUs make heavy use of the so-called single instruction, multiple
data paradigm (SIMD, see \cite{kirk2012programming_gpus} for further
information), which matches common algorithms used in MD simulations very well.
That is, MD simulations can take strong advantage of GPU architectures. Compared
to classical computing architectures, this leads to \textit{i)} a significantly
higher absolute simulation performance (measured in nanoseconds of simulated
time per day) and \textit{ii)} a much better performance per financial cost
ratio, considering acquisition cost as well as energy cost. With the MD
simulation framework Amber 12 \cite{case_amber_12} and corresponding patches
\cite{amber_12_patches}, the Amber developers were among the first to work on
and release a solid and efficient MD implementation for GPUs (pmemd.cuda, see
\cite{amber_gpu_2012,amber_gpu_pme_2013} for methodological details and
validation).

Correspondingly, we engineered a GPU computing cluster in our research group,
which required substantial amounts of planning and testing, because no
enterprise-level vendors were available for this kind of hardware. Hence, we
composed this cluster based on raw hardware and software components, eventually
yielding the following configuration:

\begin{itemize}
\item Four dedicated compute nodes, based on low-clocked Intel central
processing units on special consumer-level mainboards, placed in
temperature-regulated server racks.
\item A total of 15 GPU devices distributed among these machines (2 Tesla C2070,
3 GTX 580, 2 GTX 690, 4 GTX 770, 4 GTX TITAN, all Nvidia CUDA devices
\cite{nvidia_cuda_devices}, purchased in batches spread across 1.5 years).
\item Linux operating systems, along with appropriate drivers and CUDA runtime
libraries.
\item A customized Torque \cite{torque_website} GPU job scheduling system, see
\cite{gehrcke_torque_gpu_setup} for details.
%\item pmemd.cuda, built
\end{itemize}

With this infrastructure at hand, we were able to perform a single DMD study
within less than two weeks, without being dependent on \textit{external}
resources. On top of that, from summer 2013 on we have been part of the testing
period of the large-scale GPU computing cluster of the supercomputing center of
the TU Dresden: as a section of their \enquote{Taurus} platform, they provide 80
Nvidia CUDA GPU devices. All in all, with these GPU resources at hand, we were
able to perform single DMD studies on a weekly basis, with a significantly
increased number of DMD runs per study ($N=200$ or $300$). In Dresden, this
would not have been possible using classical computing resources.


\subsubsection{Software architecture}

Above, we derived that one DMD study is comprised of on the order of $10^3$
computing jobs, and that it requires storing hundreds of gigabytes of raw data
distributed in about $10^5$ files. These numbers suggest that the management of
corresponding jobs and data requires a well-engineered DMD controlling system.
The essential purpose of such system is to automatically identify errors and
recover from those: the likelihood for a single computing machine to fail times
the number of machines involved in a DMD study integrated over the computing
time yields a significant probability for the study to be affected by
\textit{one or more} technical issues. In other words, there is a guarantee
that something will go wrong. By experience we can tell that this prediction
came true, and manual identification of corresponding issues was a daunting
task, which is why we iteratively developed a system architecture that enables
the efficient conduction of DMD studies.

One requirement for this management architecture was to support all involved
hardware platforms, i.e.\ the Taurus GPUs, the Taurus CPUs (for data analysis),
the group-internal GPU cluster, and the biocluster CPUs (for data analysis),
whereas these platforms alone involve three different batch scheduling systems.
As all of these platforms are based on POSIX-compliant operating systems with
reliable and well-performing file systems attached, we abstracted the data
structure for managing and monitoring a DMD study on top of the file system
hierarchy, and implemented basic data creation, manipulation, and validation
using well-established POSIX command line tools, incorporated in shell scripts.

For many purposes of data validation and analysis we implemented Python
programs based on Biopython \cite{biopython_web} and SciPy/NumPy
\cite{scipy_numpy} whenever appropriate. Data plotting was performed using
the Python module Matplotlib \cite{matplotlib_web}. Iterative development and
continuous integration of this software architecture was largely facilitated by
the efficient usage of a decentralized version control system (Mercurial
\cite{mercurial_web} in this case). For reference, the corresponding code
repository is available at \url{http://bit.ly/jgehrcke-phd-dmd-control}.


\subsection{Geometrical DMD parameterization}
\label{dmdil10:method_geom_setup}

\begin{figure}
\centering
\includegraphics[width=1.0\textwidth]{gfx/dmdil10/round1_il10_ligandcenter_proteincore_sphere_top_and_side_001.jpg}
\caption[]{Geometrical DMD parameterization used for most of the DMD studies
in the first round. The IL-10 dimer is shown in gray ribbon representation (top:
side view on the V-shape, bottom: top-down view on the V-shape). The C-alpha
atom of methionine 154 in the human interleukin-10 sequence was selected as
protein core atom (ribbon colored in orange). The focus point (small sphere
colored in magenta) was selected manually based on the putative binding region
comprised by residues R102, R104, R106, R107 (colored in green sticks). The tMD
target distance of \SI{17.7}{\angstrom} between the protein core atom and the
focus point is indicated by a thick yellow dashed line. The large transparent
yellow sphere is centered on the protein core atom and its radius is set to the
tMD target distance. It visualizes the surface that contains all central ligand
atoms after tMD.}
\label{fig:dmdil10:dmd_geometry_round1}
\end{figure}

\Cref{fig:dmdil10:dmd_geometry_round1} visualizes the geometrical DMD
parameterization used for most of the DMD studies in the first round. The manual
selection of core atom and focus point was based on the binding site prediction
made in \cref{bspred:il10} and performed in compliance with the guidelines
formulated in \cref{dmd:lrom_preparation}. We ended up using the C-alpha atom of
M154 as core atom, and a tMD target distance of \SI{17.7}{\angstrom}, yielding a
quite large spherical surface for proper putative binding site sampling. If
relevant, deviations from this geometrical setup in the first or second round of
DMD studies are described in the results and discussions part.


\section{Results and discussion}

\subsection{1st round of DMD studies}

\subsubsection{DMD result consistency}

One of the first results in this round of IL-10-GAG DMD studies was the
observation of method consistency, i.e.\ support for sufficient sampling and
convergence of the DMD method.
\Cref{fig:dmdil10:hp_hexa_vs_tetra_clusters_position_match} shows the overlay
of two clustering results from two independently performed DMD studies that
differed \textit{only} in the GAG ligand length --- one was performed with a
heparin hexasaccharide, and the other with a heparin tetrasaccharide.
Rationally, one would require DMD to return a very similar binding pose
prediction in both cases, as it is unlikely for these GAG types to behave
fundamentally different. As motivated in \cref{relevance_of_clustering},
comparison of the position of the most populated clusters in both cases is a way
to (in)validate this assumption. Note that comparison of both clusters, and with
that, comparison of both DMD studies with respect to the distribution of docking
solutions, is only possible because we took great care of making both clustering
results comparable via the clustering parameter optimization described in
\cref{clustering_param_opt}. In both cases, the docking solution clustering was
performed with $N_{min}$ (the minimal number of clusters that must be found) set
to 1, and $M_{min}$ (the minimal number of members within each cluster) set to
4. In both cases, the automatic clustering parameter optimization yielded an
   $\epsilon$ value of \SI{2.6}{\angstrom}, i.e.\ just about the same density of
   docking solutions in both clusters.

\begin{figure}
\centering
\includegraphics[width=1.0\textwidth]{gfx/dmdil10/hp_hexa_vs_tetra_clusters_position_match_cropped.jpg}
\caption[]{Consistent results among two independently conducted DMD studies. The
IL-10 structure is shown in gray cartoon/line representation. The most populated
cluster of docking solutions derived from a DMD study with a heparin
hexasaccharide is shown with carbon atoms in blue. The most populated cluster of
a corresponding DMD study with a heparin tetrasaccharide is shown with carbon
atoms in green. Setup and protocol of both DMD studies differed \textit{only} in
the GAG ligand length.}
\label{fig:dmdil10:hp_hexa_vs_tetra_clusters_position_match}
\end{figure}

In essence, both clusters are positioned equivalently with respect to IL-10, and
show the same density. That is, with respect to the distribution of docking
solutions, both DMD studies returned the same result. In addition to the DMD
validation study presented in \cref{chapter:dmd}, this result supports the
significance of data created by the DMD method.


\subsubsection{Impact of N-terminal residues and modest geometry changes}

In one of the early studies we included the five N-terminal residues of IL-10
(see \ref{dmdil10:overallmethod}) and varied the geometrical parameterization of
DMD compared to the setup described in \ref{dmdil10:method_geom_setup}: we kept
the C-alpha of M154 as core atom, but slightly changed the focus point within
the anticipated binding region, resulting in a different orientation of the
yellow axis shown in \cref{fig:dmdil10:dmd_geometry_round1}, and in a tMD target
distance of \SI{20.5}{\angstrom}. The rest of the system and protocol setup was
equivalent to another DMD study with a heparin tetrasaccharide, whose
geometrical outcome is shown in
\cref{fig:dmdil10:hp_hexa_vs_tetra_clusters_position_match}. As it turned out,
the final distribution of docking solutions was not affected by both changes, as
the most populated cluster matched the position of the clusters shown in
\cref{fig:dmdil10:hp_hexa_vs_tetra_clusters_position_match}.

We conclude that the results of a DMD study are rather insensitive with respect
to modest changes in the geometrical parameterization of DMD, and that the
presence of the five N-terminal residues does not significantly affect the DMD
binding pose prediction, and therefore is not of the highest priority to study.


\subsubsection{Distinction among GAG types by single-run quantity cluster stats}

\begin{table}
\footnotesize
\centering
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{lcrll}
\midrule
GAG type                 & cluster members & $\epsilon$ (\si{\angstrom}) & $m$ (\si{\angstrom}) & $\Delta G$ (\si{\kilo\calory\per\mol}) \\
\midrule
HP dp6                   & 4               & 2.5                         & 2.8 $\pm$ 0.7          & -45 $\pm$ 15                           \\
CS4 dp6                  & 5               & 3.2                         & 2.6 $\pm$ 0.3          & -37 $\pm$ 8                            \\
CS4 dp6 (2nd cluster) & 4               & 3.2                         & 2.4 $\pm$ 0.4          & -37 $\pm$ 14                          \\
\midrule
\end{tabular}
\caption{
Characterization of most populated clusters by single-run quantity cluster stats
for two different DMD studies differing \textit{only} in the GAG type. In one
study, we used a heparin hexasaccharide (dp6), in the other we used a
chondroitin-4-sulfate (CS4) hexasaccharide. The heparin study yielded a single
prominent cluster, the CS4 study yielded two similar clusters. $\epsilon$ is the
spatial density of docking solutions according to \cref{clustering_param_opt}.
$m$ is the mobility of the ligand relative to the receptor, as defined in
\cref{dmd:dataanalysis}. Here, $\Delta G$ is the free energy of binding
estimate as provided by the MM-PBSA method \cref{methods:mmpbsa_mmgbsa}. The
standard deviations shown are derived from the cluster-internal variations.}
\label{tab:dmdil10:round1_different_gag_types}
\end{table}

Ideally, different behavior of different GAG types is expressed in the docking
solution clustering, and especially in the single-run quantities evaluated on a
per-cluster basis. The characterization of most populated clusters for two
different DMD studies differing \textit{only} in the GAG type should be
discussed by means of an example. In one study, we used a heparin hexasaccharide
(dp6), in another we used a chondroitin-4-sulfate (CS4) hexasaccharide. The
heparin study yielded a single prominent cluster, the CS4 study yielded two
similar clusters. The placement of the clusters relative to IL-10 was similar
(data not shown), and the quantitative evaluation of both clusters yielded
similar results, see \cref{tab:dmdil10:round1_different_gag_types}: among the
three clusters, the ligand movement relative to the receptor as well as the
MM-PBSA free energy of binding estimate are indistinguishable, considering the
cluster-internal fluctuations represented by the standard deviations. Just the
cluster density indicates that the docking solutions obtained for heparin show a
little more spatial consistency than the solutions obtained for CS4.

The important conclusion to be drawn from this and comparable observations (data
not shown) is that the IL-10-GAG system does not easily allow for a quantitative
distinction of different GAG types via DMD.





\subsubsection{R107 stands out by hydrogen bonding and SRED}


result of two docking
- Show picture of R107 specifically marked in the structure


R107 significantly stands out compared to all other residues
and supposedly plays a particularly important role in IL-10-
GAG recognition.
(conserved in mouse)

Observations in first round of studies:

\begin{itemize}

\item N=200 and N=300 for much clearer clustering and , reduction of target displacement length
to 25  Angstroms and pulling process simulation time to 3 ns instead of 4 without
observable caveats.

\item slight change in DMD geometry parameterization does not change outcome (different starting conditions, very similar outcome -- show figure on page 25 of 131030 3rd tac )

%\item Heparin length change yields same outcome

\item Complete inclusion of IL-10's N terminus does not qualitatively change hbond/SRED data (130530 groupmeeting pdf)

%\item Again: DMD reproducible results!

\item MM-GBSA SRED yields consistent outcome with hydrogen bonding analysis,
whereas hbond analysis is much simpler

\end{itemize}



\subsection{2nd round of DMD studies}

\subsubsection{R107A mutation}

\hl{If there is not enough content here, do not make this a (sub)section}

Most important result: No other residue could take the role of R107,

\subsection{Conclusions}

\hl{So far, about 10 independent DMD studies involving IL-10 and different GAGs
have been performed. An important intermediate result of the corresponding data
analysis is that one amino acid residue, R107 (in the hIL-10 sequence, conserved
in mouse), significantly stands out compared to all other residues and
supposedly plays a particularly important role in IL-10-GAG recognition. This
conclusion is based on different types of data, including time-averaged hydrogen
bonding analysis and single-residue energy decomposition applied to MD data
collected on the microsecond time scale}.

