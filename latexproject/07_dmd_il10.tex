\chapter{DMD applied to the IL-10-GAG system}

In order to exploit the predictive power of DMD for the IL-10-GAG system, we
have performed several DMD studies differing in DMD parameterization and
molecular system setup. Conducting these studies required an increment of the
computational resources available to us by orders of magnitudes. In the course
of performing these studies we continuously refined our software architecture
for controlling the corresponding high performance computing resources and
enriched our DMD data analysis framework. This chapter seeks to present
\textit{i)} the computational challenges, \textit{ii)} the methodological
details, and \textit{iii)} the major outcomes of this endeavor.


\section{Methods}

\subsection{DMD study design}

As a reminder, the term DMD study covers many DMD run repetitions followed by
data analysis. Hence, within a single DMD study the \textit{constants} are ---
among others --- the chemical configuration of the ligand molecule and the
geometrical DMD parametrization, i.e.\ the protein core atom and the focus
point. Clearly, a systematic investigation of the IL-10-GAG system via DMD
requires \textit{variation} of exactly these entities. That is, the planned
investigation requires the conduction of \textit{many} DMD studies. By the time
of designing the first IL-10-GAG DMD studies, the conduction and analysis of a
single study consumed about two weeks. Hence, time and computational resources
clearly limited the scope of this endeavor. In these lines, the requirement was
to get as much conclusive output out of as few DMD studies as possible.

\subsubsection{Factors to investigate}

The entities that are obviously interesting to vary among the different DMD
studies in case of the IL-10-GAG system are:

\begin{itemize}

\item[1)] \textbf{The DMD protocol.} In the course of performing various DMD
studies we aimed for slight protocol changes for optimizing the computational
efficiency of DMD, compared to the protocol initially developed for the DMD
validation study described in \cref{chapter:dmd}. We decided to potentially
optimize parameters such as decreasing the tMD simulation length as well as the
LROM displacement length, both of which have direct impact on the pulling
process velocity. A the same time, we tried to increase the number of
independent DMD run repetitions within single DMD studies as far as our
computational resources allowed to, in order to obtain as much sampling
performance as possible.

\item[2)] \textbf{The geometrical DMD parameterization.} In
\cref{chapter:bspred}, we have derived a region of interest for our DMD studies.
For potentially discovering a distinct and well-defined binding \textit{site}
and for investigating and finally eliminating the impact of the geometrical DMD
parameterization on any conclusion about the IL-10-GAG system, we decided to
vary DMD focus point and entry lane among the DMD studies. One should note
however, that in order to obtain reliable information about the impact of other
variables, this one here should stay constant most of the time, which is why we
decided to try only two different geometrical setups in the first round of DMD
studies, and a final third geometrical parameterization in the second round of
DMD studies.

\item[3)] \textbf{The representation of IL-10's N-terminus in the MD
simulations}. In IL-10's crystal structure with PDB 2ILK the first 5 residues of
the N-terminus are not resolved as of their flexibility. The N-terminus is close
to our main region of interest derived in \cref{chapter:bspred}. This is an
unfortunate situation, because if this terminus plays a role in GAG recognition,
it would not easily be possible for us to detect it --- modeling the behavior of
such flexible / disordered terminus is not possible with all certainty and
requires special sampling techniques on its own, not \textit{per se} combinable
with DMD. Primarily, we take the flexibility and sequence as an argument that
the N-terminus is surely less important for specific GAG interaction than the
amino acid residues in the region we have identified. Since simulating the
disordered N-terminus without special treatment is pointless, we have omitted
these five residues from most of our MD simulations. However, for having a
comparison, and for obtaining an idea about their possible impact, we decided to
include them in at least one or two test case DMD studies.

\item[4)] \textbf{The chemical configuration of GAG ligands.} Obviously, we had
the hope to identify characteristic differences among different GAG types and
lengths with respect to their interaction with our IL-10 region of interest.
Therefore, we aimed to perform DMD studies with constant conditions while
varying the chemical configuration of the GAG molecule. As of the limited amount
of computational resources, we had to decide which GAG types/lengths are most
interesting for our investigation and came up with the following selection:

\begin{itemize}

\item \textit{Heparin}, a must-have in this list, as its interaction with IL-10
has been experimentally confirmed previously \cite{salek_ardakani_2000}. We
decided to study heparin tetra- as well as hexasaccharides. In our DMD
validation study we have shown that DMD is capable of properly sampling the
internal degrees of freedom of GAG hexasaccharides. For longer GAGs, however, we
would be uncertain regarding the sufficiency of the sampling and --- with that
--- the reliability of the results. Additionally, tetrasaccharide investigation
is useful for observing potential (in)consistencies in our observations
depending on GAG length. Disaccharide investigation, however, would likely be a
waste of computational resources.

\item \textit{Hyaluronan}, which is the only natural GAG free of sulfation. As
of its lack of sulfate groups, besides of being less charged, it has
significantly different spatial properties than e.g.\ heparin: it is less bulky
(i.e.\ it is slim).

\item \textit{Chondroitin-4-sulfate}. The chondroitin sulfates are important
representatives of the class of GAGs. Compared to heparin, the 4- and 6-
variants of chondroitin sulfate have two sulfate groups less per disaccharide
unit (only one) and are therefore less charged and less bulky.

\item \textit{Chondroitin-6-sulfate}. Carbon 6 of the
N-Acetyl\-ga\-lacto\-sa\-mine is sulfated, meaning that the sulfate group is
protruding further into space than in case of chondroitin-4-sulfate, where the
sulfate is attached directly to the ring (cf. \cref{intro:gags}), providing this
GAG with quite different spatial properties than chondroitin-4-sulfate.

\end{itemize}

\end{itemize}

\subsubsection{Iterative approach}

For the global design of our DMD studies, we decided to take an iterative
approach. In a first round, we aimed to gather experience about how the
IL-10-GAG system responds to various kinds of DMD parameter changes.
Furthermore, since the technical environment was unstable, we used this first
round of studies for detecting and resolving technical issues. Hence, in this
first round of studies, we varied the conditions according to all points
described above, with the goal to obtain stable conditions applicable in a
second round, together with an optimized geometrical DMD parameterization.


\subsubsection{Automated DMD data analysis}

For efficiently breaking the enormous amount of raw data produced by any DMD
study down to human-interpretable essentials, we specified and implemented an
automated data analysis framework. In this framework, every DMD run within a DMD
study is assigned a unique identifier. Subsequently, we extracted all
\textit{static} and \textit{dynamic} quantities for each DMD run listed in
\cref{dmd:dataanalysis}, and assigned those quantities to the corresponding
run identifiers. As a result, we obtained a table of dimensions $N \times M$,
with $N$ being the number of DMD runs and $M$ being the number of
single-run-derivable quantities. In a second class of analyses, the
ensemble-derivable quantities as described in \cref{dmd:dataanalysis} were
extracted from all runs in the DMD study, usually based on the single-run data
extraction performed before. Finally, we clustered the docking solution ensemble
using the method described in
\cref{chapter:bspred}.

The resulting reduced set of data allows for a broad subsequent data analysis.
For instance, any two single-run-derivable quantities can easily be correlated
for understanding their relationship, or the distribution of any extracted
quantity can easily be looked at and statistically evaluated. Furthermore, our
data analysis framework allows for generating cluster statistics based on the
\textit{clustering} of docking solutions. For instance, the average ligand
mobility within a certain cluster is easy to obtain. This enables meaningful
comparison of clusters by those properties, especially among \textit{different}
DMD studies.


\subsection{Computational framework}

\subsubsection{High performance computing (HPC) requirements of one DMD study}


One DMD study according to the protocol as presented in \cref{chapter:dmd},
i.e.\ with $N = 100$ repetitions, a pulling process simulation time of
\SI{4}{\nano\second} and a free MD simulation time of \SI{10}{\nano\second}
implicates about \SI{1.4}{\micro\second} of simulated real time. As of these
numbers, one DMD study requires about 12 years ($10^5$ hours) of CPU time using
state-of-the-art hardware (such as the Intel® Xeon® Processor X5650).

In high performance computing, computational tasks are usually abstracted as
\enquote{jobs}, whereas a job is a sub-problem of an
\enquote{embarrassingly parallel} problem \cite{heath1986hypercube}, for which
little or no effort is required to separate the problem into a number of
independent tasks. For efficient use of HPC batch schedulers for DMD, we have
abstracted a DMD study into the following list of jobs (whereas some of the jobs
named later in the list require completion of those listed earlier):

\begin{itemize}
\item LROM system preparation jobs (minimization, heat-up, equilibration)
\item $N$ tMD production jobs
\item $N$ free MD jobs (minimization, heat-up, equilibration, production)
\item $N$ final state validation and energy minimization jobs
\item $N$ free MD trajectory analysis jobs (MM-PBSA)
\item $N$ free MD trajectory analysis jobs (MM-GBSA + SRED)
\item $N$ free MD trajectory analysis jobs (geometry and hydrogen bonding
analysis)
\end{itemize}

Depending on $N$, this yields on the order of $10^3$ computing jobs per DMD
study. The raw data created by those jobs comprises on the order of $10^2$
gigabytes distributed in about $10^5$ files. These numbers suggest that the
management of corresponding jobs and data requires a well-engineered DMD
controlling system. The essential purpose of such system is to automatically
identify errors and recover from those: the likelihood for a single computing
machine to fail times the number of machines involved in a DMD study integrated
over the computing time yields a significant probability for the study to be
affected by one or more technical issues. By experience we can tell that this
prediction came true.

is
integrated over  the number of independent computing nodes
involved in a single DMD study, it is quite likely affected

 This is
often the case where there exists no dependency (or communication) between those
parallel tasks


For us,
conduction of a single study was possible within about two weeks, using the
\enquote{Atlas} resource pool in the supercomputing center of the TU Dresden
(ZIH), which provisions a large number of AMD Opteron 6274 CPUs.


, and about
\SI{1.0}{\micro\second}


On , one DMD study consumes about 10 years of CPU time.
By the time of the first DMD studies performed, the. Independently, we have started
establishing a group-internal compute cluster making use of specialized GPU
hardware. Using this, one DMD study can also be performed in about two weeks.
Recently, the ZIH has introduced GPU hardware. We have been part of the testing
period and started using their GPU resources for DMD production runs.

For the purpose of being able to apply DMD on a scale as required by this study,
we have established a


\subsubsection{Establishment and testing of HPC graphics processing unit (GPU) infrastructure}



        - Computing resources
            - Establishment of GPU infrastructure
                - Software: compilation of Amber 12 against ...
                - built up group-internal GPU cluster:
                    4 machines, this hardware, PBS schedular with Python wrapper
                - ZIH resources

\subsubsection{Software architecture}

        - Architecture:
            shell scripts, file system for study organization
            Python/numpy/scipy/matplotlib for analysis
            code on bitbucket



\section{Results and discussion}

\subsection{1st round of DMD studies}



So far, about 10 independent DMD studies involving IL-10 and different GAGs have
been performed. An important intermediate result of the corresponding data analysis
is that one amino acid residue, R107 (in the hIL-10 sequence, conserved in mouse), significantly
stands out compared to all other residues and supposedly plays a particularly
important role in IL-10-GAG recognition. This conclusion is based on different types
of data, including time-averaged hydrogen bonding analysis and single-residue energy
decomposition applied to MD data collected on the microsecond time scale

- Show picture of R107 specifically marked in the structure


R107 significantly stands out compared to all other residues
and supposedly plays a particularly important role in IL-10-
GAG recognition.
(conserved in mouse)

Observations in first round of studies:

\begin{itemize}

\item N=200 and N=300 for much clearer clustering and , reduction of target displacement length
to 25  Angstroms and pulling process simulation time to 3 ns instead of 4 without
observable caveats.

\item slight change in DMD geometry parameterization does not change outcome (different starting conditions, very similar outcome -- show figure on page 25 of 131030 3rd tac )

\item Heparin length change yields same outcome

\item Complete inclusion of IL-10's N terminus does not qualitatively change hbond/SRED data (130530 groupmeeting pdf)

\item Again: DMD reproducible results!

\item MM-GBSA SRED yields consistent outcome with hydrogen bonding analysis,
whereas hbond analysis is much simpler


\end{itemize}

\subsection{2nd round of DMD studies}

\subsubsection{R107A mutation}

\hl{If there is not enough content here, do not make this a (sub)section}

Most important result: No other residue could take the role of R107,

